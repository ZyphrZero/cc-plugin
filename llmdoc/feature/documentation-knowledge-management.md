# 文档知识管理

## 1. Purpose

文档知识管理功能通过recorder agent提供结构化的项目知识库维护服务。该功能确保项目文档作为单一真实来源，通过索引原子性机制保持文档系统的一致性和完整性，专注于开发者文档，排除教程和指南类内容，为项目团队提供可靠的代码设计、架构和维护参考。

## 2. How it Works / Step-by-Step Guide

### 核心架构设计

文档系统采用层次化目录结构：
- **index.md** - 主索引文件，作为单一入口点
- **sop/** - 标准操作流程目录
- **feature/** - 功能特性文档目录
- **agent/** - 代理输出文档目录

### 索引原子性机制

1. **创建/修改文档**: 在相应目录创建或更新内容文档
2. **立即同步**: 必须在同一个操作中更新index.md
3. **无异常处理**: 任何文档操作都必须伴随索引更新，无例外

### 标准化文档结构

所有文档都遵循统一的四段式结构：

```markdown
# [Document Title]

## 1. Purpose
简明解释功能/流程及其解决的问题

## 2. How it Works / Step-by-Step Guide
技术架构描述或步骤指南

## 3. Relevant Code Modules
相关代码文件或目录的绝对路径列表

## 4. Attention(if have)
需要注意的事项列表(不超过10行)
```

### 操作工作流程

#### Phase 1: 上下文获取和规划
1. **任务接收**: 接收git diff输出、其他代理报告或直接指令
2. **索引加载**: 首先读取`/llmdoc/index.md`
3. **分析和计划**: 交叉引用输入与主索引，确定必要的CREATE/UPDATE/DELETE操作

#### Phase 2: 执行
1. **内容修改**: 使用Read/Write/Edit修改内容文件
2. **复杂处理**: 如需多文档则创建子目录结构
3. **索引同步**: 立即更新index.md以反映变更

### 文档质量要求

- **真实性**: 基于实际代码生成，禁止编造或推测
- **简洁性**: 每个文档不超过250行，避免冗余信息
- **具体性**: 提供代码路径、核心数据设计、数据流和相关信息
- **开发者导向**: 专注于代码设计实现、架构、维护和模块划分

## 3. Relevant Code Modules

- `agents/recorder.md` - recorder agent完整定义，包含操作流程和标准格式
- `commands/withDoc.md` - withDoc命令，作为技术项目经理协调文档生成
- `llmdoc/index.md` - 主索引文件，作为文档系统的单一入口点
- `llmdoc/sop/` - 标准操作流程文档目录
- `llmdoc/feature/` - 功能特性文档目录
- `llmdoc/agent/` - 代理输出文档目录

## 4. Attention

- **索引同步**: 任何文档操作都必须立即更新index.md，这是强制要求
- **内容真实**: 严格禁止编造内容，必须基于实际代码生成文档
- **路径规范**: 文档中使用相对路径，绝对路径仅用于内部处理
- **长度控制**: 超过250行表明存在冗余或不必要信息
- **功能分离**: 文档专注于开发团队需求，排除教程、指南、快速入门内容
- **更新顺序**: 必须先完成文档内容修改，再更新index.md，顺序不可颠倒
- **版本一致性**: 确保index.md中的链接与实际文件位置保持同步
- **目录规范**: 严格按照feature/sop/agent的目录结构组织文档